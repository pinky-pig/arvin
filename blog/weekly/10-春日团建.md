---
title: ç¬¬10æœŸ - æ˜¥æ—¥å›¢å»º
date: 2023/05/15
desc: å‘¨æœ«è·Ÿæ˜¥æ˜¥ä¸€èµ·å»å‚åŠ äº†å…¬å¸å›¢å»ºï¼Œä¸Šåˆçœ‹å®Œç”µå½±ï¼Œä¸‹åˆå»éœ²è¥ï¼Œä½†æ˜¯å‘ç°æœ‰é›†ä½“æ¸¸æˆæ´»åŠ¨ï¼Œå°±æºœäº†ï¼Œå¤ªæ™’äº†......
tags: ['#Weekly']
cover: https://cdn.jsdelivr.net/gh/pinky-pig/pic-bed/imageså›¢å»º.jpg
---

[[toc]]

<p align="center">
  <img alt="æ˜¥æ—¥å›¢å»º" src="https://cdn.jsdelivr.net/gh/pinky-pig/pic-bed/imageså›¢å»º.jpg" width=800 />
</p>

## æŠ€æœ¯ç›¸å…³

**Playwright screenshots**

åœ¨çœ‹æ¨ç‰¹çš„æ—¶å€™ï¼Œçœ‹åˆ°äº†ä¸€ç¯‡æ¨æ–‡ï¼Œåœ¨[ç½‘ç«™](https://cali.so/)ä¸­ç›´æ¥é¢„è§ˆç½‘å€çš„æˆªå›¾ï¼Œæ„Ÿè§‰å¾ˆæœ‰æ„æ€ã€‚çœ‹ä»–ä¸‹é¢çš„å›å¤ï¼Œæ˜¯åˆ©ç”¨ _Playwright_ ä½¿ç”¨ä¸€ä¸ª chromium çš„ headless æ¨¡å¼ï¼Œç„¶åæˆªå›¾ï¼Œç„¶åè¿”å›ç»™å‰ç«¯ã€‚ç”±äºä»–ç›´æ¥ä½¿ç”¨çš„ Next.js ï¼Œæ‰€ä»¥æ›´ç®€å•ï¼Œç›´æ¥åœ¨å‰ç«¯é¡¹ç›®ä¸­ä½¿ç”¨ã€‚

ç„¶å Google äº†ä¸€ä¸‹ï¼Œå‘ç° YouTube ä¸Šæœ‰ä¸ªæ•™ç¨‹ <https://www.youtube.com/watch?v=t95Jo1Wdljw> ï¼Œ ç„¶åä»–çš„ GitHub ä¸Šä¹Ÿæœ‰æºç  <https://github.com/colbyfayock/my-web-archive> ã€‚

äºæ˜¯æˆ‘ä¾¿æƒ³åœ¨ Nuxt.js ä¸Šä¹Ÿé‡ç°ä¸€ä¸‹ğŸ˜

å½“ç„¶ï¼Œé¦–å…ˆè‚¯å®šæ˜¯è¦åœ¨ Node.js ç¯å¢ƒä¸‹å®ç°ä¸€ä¸‹ï¼Œè¿™é‡Œæ˜¯ code ã€‚

```javascript
// core
const fs = require('node:fs')
const { chromium } = require('playwright');

(async () => {
  // ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨æµè§ˆå™¨å¹¶æ‰“å¼€æ–°é¡µé¢
  const browser = await chromium.launch()
  const page = await browser.newPage()
  // ç¬¬äºŒæ­¥ï¼šåŠ è½½ç½‘é¡µå¹¶ç­‰å¾… DOM å‡†å¤‡å°±ç»ª
  await page.goto('https://www.baidu.com')
  await page.waitForLoadState('domcontentloaded')
  // ç¬¬ä¸‰æ­¥ï¼šå°†æ•´ä¸ªé¡µé¢æˆªå›¾å¹¶ä¿å­˜ä¸ºæ–‡ä»¶
  await page.screenshot({ path: 'example.png' })
  // ç¬¬å››æ­¥ï¼šå…³é—­æµè§ˆå™¨
  await browser.close()
  console.log('æˆªå›¾å·²ä¿å­˜')
})()

```

```json
// package.json
{
  "scripts": {
    "test": "node index.js"
  },
  "dependencies": {
    "fs": "^0.0.1-security",
    "playwright": "^1.14.1"
  }
}
```

è¯¦ç»†åœ¨ Nuxt.js çš„ä½¿ç”¨ï¼Œåœ¨åé¢ä¼šå†è¡¥å……ğŸ¤£ã€‚

**Chromium View Transitions API Issue**
Bug Gif:

![viewtransitionsapi](https://cdn.jsdelivr.net/gh/pinky-pig/pic-bed/imagesviewtransitionsapi.gif)

Bug å¤ç° Codeï¼š

```html
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="initial-scale=1.0, user-scalable=no, width=device-width"
    />
    <title>View Transitions API</title>
    <style>
      html.dark {
        background: #222;
      }
      html {
        background: #fff;
      }
      .pic {
        transform: rotate(330deg) translate3d(110px, 10px, 10px);
        border-radius: 0.375rem;
      }
      .container {
        overflow: hidden;
      }

      ::view-transition-old(root),
      ::view-transition-new(root) {
        animation: none;
        mix-blend-mode: normal;
      }

      /* è¿›å…¥darkæ¨¡å¼å’Œé€€å‡ºdarkæ¨¡å¼æ—¶ï¼Œä¸¤ä¸ªå›¾åƒçš„ä½ç½®é¡ºåºæ­£å¥½ç›¸å */
      .dark::view-transition-old(root) {
        z-index: 1;
      }
      .dark::view-transition-new(root) {
        z-index: 999;
      }

      ::view-transition-old(root) {
        z-index: 999;
      }
      ::view-transition-new(root) {
        z-index: 1;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <img class="pic" src="https://placekitten.com/g/400/400" alt="" />
    </div>

    <button onclick="toggleTheme(event)">Toggle Theme</button>

    <script type="text/javascript">
      const duration = 1000
      function toggleTheme(event) {
        const x = event.clientX
        const y = event.clientY
        const endRadius = Math.hypot(
          Math.max(x, innerWidth - x),
          Math.max(y, innerHeight - y),
        )

        let isDark = false
        const transition = document.startViewTransition(() => {
          const root = document.documentElement
          isDark = root.classList.contains('dark')
          root.classList.remove(isDark ? 'dark' : 'light')
          root.classList.add(isDark ? 'light' : 'dark')
        })

        transition.ready.then(() => {
          const clipPath = [
            `circle(0px at ${x}px ${y}px)`,
            `circle(${endRadius}px at ${x}px ${y}px)`,
          ]
          document.documentElement.animate(
            {
              clipPath: isDark ? [...clipPath].reverse() : clipPath,
            },
            {
              duration,
              easing: 'ease-in',
              pseudoElement: isDark
                ? '::view-transition-old(root)'
                : '::view-transition-new(root)',
            },
          )
        })
      }
    </script>
  </body>
</html>
```

## ç”Ÿæ´»ç›¸å…³

å‘¨å…­å»å‚è§äº†å…¬å¸å›¢å»ºï¼ŒåŒäº‹ä»¬æ„Ÿè§‰éƒ½æœ‰ç‚¹æŠ—æ‹’ï¼Œæˆ‘çŒœä¸»è¦æ˜¯å› ä¸ºå ç”¨äº†å‘¨å…­ï¼Œè€Œä¸”å¤©æ°”å¥½çƒ­ï¼Œè¯´ä¸å®šè¿˜ä¼šæœ‰ä¸€äº›æ€æƒ³æ•™è‚²æˆ–æ˜¯æ— èŠçš„å›¢ä½“æ¸¸æˆã€‚ä½†æ˜¯æˆ‘çœ‹äº†æ´»åŠ¨å®‰æ’ã€‚å…¶å®è§‰å¾—è¿˜è¡Œå•Šï¼Œä¸Šåˆçœ‹ç”µå½± ã€ŠæƒŠå¤©æ•‘æ´ã€‹ ï¼Œç„¶åå»éœ²è¥ã€‚

æˆ‘è·Ÿæ˜¥æ˜¥æ—©ä¸Šä¸ƒç‚¹å¤šå°±é†’äº†ï¼Œç„¶åååœ°é“èµ¶è¿‡å»ï¼Œåˆšå¥½ç”µå½±å¼€å§‹ã€‚çœ‹å®Œäº†ç”µå½±ä¹‹åçš„æ„Ÿè§‰ï¼Œåªèƒ½è¯´å‰§æƒ…éƒ½èƒ½çŒœå¾—åˆ°ï¼Œåƒæ˜¯ä¸€éƒ¨æ¶ˆé˜²å®£ä¼ ç‰‡ã€‚ã€‚ã€‚ä¸è¿‡åœºé¢è¿˜è¡Œï¼ŒæŒºå¥½çœ‹çš„ã€‚

çœ‹å®Œç”µå½±ï¼Œéª‘ç€ç”µåŠ¨è½¦ï¼Œé¡¶ç€å¤§å¤ªé˜³ï¼Œç›´å†²éœ²è¥åœ°ã€‚æˆ‘ä»¬åˆ°çš„æ—¶å€™ï¼Œä»–ä»¬è¿˜æ²¡åˆ°å¤šå°‘äººï¼Œç›´æ¥å¼€åƒï¼ï¼

ç„¶åé¥­åæ­‡äº†ä¸€ä¼šå°±å¼€æºœäº†ğŸ˜ï¼Œå¤ªæ™’äº†ï¼Œè€Œä¸”è¿˜æœ‰é›†ä½“æ¸¸æˆï¼Œæˆ‘å¯ä¸æƒ³å‚åŠ ã€‚

å¸Œæœ›åé¢è‡ªå·±ä¹°ä¸€äº›éœ²è¥çš„è£…å¤‡ï¼Œç„¶åè‡ªå·±å»éœ²è¥ï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ã€‚
